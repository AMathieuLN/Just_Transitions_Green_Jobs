"0","library(ggplot2)"
"0","library(dplyr)"
"0",""
"0","# CrÃ©er un dataframe avec les seuils des outliers corrigÃ©s"
"0","outlier_thresholds <- data.frame("
"0","  income_group_label = c(""Revenu Ã©levÃ©"", ""Revenu intermÃ©diaire supÃ©rieur"", ""Revenu intermÃ©diaire infÃ©rieur"", ""Faible revenu""),"
"0","  Lower_Bound = c(30.31, 43.88, 49.15, 40.31),  # Seuils infÃ©rieurs pour chaque groupe de revenu"
"0","  color = c(""purple"", ""blue"", ""green"", ""red"")  # Couleurs associÃ©es aux groupes"
"0",")"
"0",""
"0","# GÃ©nÃ©rer une couleur unique pour chaque pays"
"0","unique_countries <- unique(evolution_data$country_label)"
"0","country_colors <- setNames("
"0","  grDevices::rainbow(length(unique_countries)),  # Palette de couleurs distinctes"
"0","  unique_countries"
"0",")"
"0",""
"0","# Combiner les couleurs des seuils et des pays"
"0","threshold_colors <- setNames(outlier_thresholds$color, outlier_thresholds$income_group_label)"
"0","combined_colors <- c(threshold_colors, country_colors)"
"0",""
"0","# CrÃ©er le graphique avec les seuils d'outliers et des couleurs uniques"
"0","trend_plot <- ggplot(evolution_data, aes(x = year, y = JTS, group = iso3c, color = country_label)) +"
"0","  geom_line(size = 1) +  # Lignes pour chaque pays"
"0","  geom_point(aes(size = abs(annual_change), shape = significant_change), alpha = 0.7) +  # Points pour chaque annÃ©e"
"0","  scale_size_continuous(range = c(2, 6)) +  # Ã‰chelle de la taille des points"
"0","  scale_shape_manual("
"0","    values = c(""Inflexion"" = 17, ""Stable"" = 16),  # Triangle pour inflexion, cercle pour stable"
"0","    name = ""Type de changement"""
"0","  ) +"
"0","  geom_hline("
"0","    data = outlier_thresholds,"
"0","    aes(yintercept = Lower_Bound, color = income_group_label),  # Utilise les seuils et leurs couleurs"
"0","    linetype = ""dashed"","
"0","    size = 0.8,"
"0","    inherit.aes = FALSE  # Prevent conflicts with main aes mappings"
"0","  ) +"
"0","  scale_x_continuous("
"0","    breaks = seq(2011, 2022, by = 1),  # Forcer les annÃ©es entiÃ¨res comme graduations"
"0","    labels = seq(2011, 2022, by = 1)   # Utiliser des annÃ©es comme Ã©tiquettes"
"0","  ) +"
"0","  scale_color_manual("
"0","    values = combined_colors,  # Combinaison des couleurs des seuils et des pays"
"0","    breaks = c(names(threshold_colors), names(country_colors)),  # LÃ©gendes pour seuils et pays"
"0","    labels = c(names(threshold_colors), names(country_colors))   # LibellÃ©s pour seuils et pays"
"0","  ) +"
"0","  labs("
"0","    title = """","
"0","    x = ""AnnÃ©e"","
"0","    y = ""Just Transition Score (JTS)"","
"0","    color = ""Pays (Groupe de revenu)\nSeuils (Couleurs par revenu)"","
"0","    size = ""Amplitude du changement"","
"0","    shape = ""Type de changement"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme("
"0","    legend.position = ""right"","
"0","    legend.text = element_text(size = 10),"
"0","    panel.grid = element_line(color = ""grey90""),"
"0","    plot.title = element_text(size = 14, face = ""bold"")"
"0","  )"
"2","Warning in geom_hline(data = outlier_thresholds, aes(yintercept = Lower_Bound,  :"
"2","
 "
"2"," [38;5;232mIgnoring unknown parameters: `inherit.aes`[39m
"
"0","# Afficher le graphique"
"0","print(trend_plot)"
